<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Projeto Completo ‚Äî GIF, M√∫sica e Desenho</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #1b1b1b; color: #fff; }
    header { background: #282828; padding: 15px; text-align: center; font-size: 22px; font-weight: bold; }
    .container { display: flex; height: calc(100vh - 60px); }
    .sidebar { width: 300px; background: #202020; padding: 15px; overflow-y: auto; border-right: 2px solid #333; }
    .content { flex: 1; padding: 15px; overflow-y: auto; }
    .box { background: #2a2a2a; padding: 10px; margin-bottom: 15px; border-radius: 8px; }
    canvas { background: #fff; border: 2px solid #444; border-radius: 6px; }
    button, select, input { margin: 5px 0; padding: 7px; width: 100%; border: none; border-radius: 4px; }
    button { background: #444; color: #fff; cursor: pointer; }
    button:hover { background: #666; }
    img { max-width: 100%; border-radius: 8px; }
  </style>
</head>
<body>
<header>üìå Projeto Completo ‚Äî GIF ‚Ä¢ M√∫sica ‚Ä¢ Desenho Avan√ßado</header>
<div class="container">
  <div class="sidebar">

    <!-- GIFs -->
    <div class="box">
      <h3>üéûÔ∏è GIF / Imagem</h3>
      <input type="text" id="gifURL" placeholder="Cole o link do GIF" />
      <button id="loadGif">Carregar GIF</button>
      <button id="clearGif">Limpar</button>
      <button id="addSampleBtn">GIF Aleat√≥rio</button>
    </div>

    <!-- M√∫sica -->
    <div class="box">
      <h3>üéµ M√∫sica</h3>
      <input type="file" id="musicFile" accept="audio/*" />
      <audio id="player" controls style="width:100%; margin-top: 10px;"></audio>
    </div>

    <!-- Ferramentas do Desenho -->
    <div class="box">
      <h3>üé® Ferramentas de Desenho</h3>
      <select id="tool">
        <option value="brush">Pincel</option>
        <option value="eraser">Borracha</option>
        <option value="line">Linha</option>
        <option value="rect">Ret√¢ngulo</option>
        <option value="circle">C√≠rculo</option>
        <option value="spray">Spray</option>
        <option value="marker">Marcador</option>
        <option value="softbrush">Brush Suave</option>
        <option value="polygon">Pol√≠gono</option>
        <option value="move">Mover tela</option>
        <option value="zoom">Zoom</option>
      </select>

      <label>Cor:</label>
      <input type="color" id="color" value="#000000">

      <label>Tamanho:</label>
      <input type="range" id="size" min="1" max="60" value="5">

      <label>Opacidade:</label>
      <input type="range" id="opacity" min="0.1" max="1" value="1" step="0.1">

      <button id="undoBtn">‚Ü©Ô∏è Desfazer</button>
      <button id="redoBtn">‚Ü™Ô∏è Refazer</button>
      <button id="addLayerBtn">‚ûï Nova Camada</button>
      <button id="saveBtn">üíæ Salvar PNG</button>
      <button id="importImgBtn">Importar Imagem</button>
    </div>

  </div>

  <!-- √Årea de Exibi√ß√£o principal -->
  <div class="content">
    <div id="gifContainer"></div>
    <br>

    <canvas id="drawCanvas" width="1000" height="600"></canvas>
  </div>
</div>

<script>
// =============================
// GIF LOADER
// =============================
const gifInput = document.getElementById('gifURL');
const gifContainer = document.getElementById('gifContainer');

document.getElementById('loadGif').onclick = () => {
  const url = gifInput.value.trim();
  if (!url) return;
  gifContainer.innerHTML = `<img src="${url}" alt="GIF">`;
};

document.getElementById('clearGif').onclick = () => {
  gifContainer.innerHTML = '';
};

// Exemplos de GIFs
const samples = [
  'https://i.imgur.com/4AiXzf8.gif',
  'https://media.giphy.com/media/3o7aD2saalBwwftBIY/giphy.gif',
  'https://media.giphy.com/media/l0MYt5jPR6QX5pnqM/giphy.gif'
];

addSampleBtn.onclick = () => {
  const url = samples[Math.floor(Math.random() * samples.length)];
  gifContainer.innerHTML = `<img src="${url}">`;
};

// =============================
// M√öSICA
// =============================
const player = document.getElementById('player');
const musicFile = document.getElementById('musicFile');

musicFile.onchange = () => {
  const file = musicFile.files[0];
  if (file) {
    player.src = URL.createObjectURL(file);
    player.play();
  }
};

// =============================
// DESENHO AVAN√áADO
// =============================
const canvas = document.getElementById('drawCanvas');
const ctx = canvas.getContext('2d');

let drawing = false;
let tool = document.getElementById('tool').value;
let color = document.getElementById('color').value;
let size = document.getElementById('size').value;
let opacity = document.getElementById('opacity').value;
let startX = 0, startY = 0;
let undoStack = [], redoStack = [];

function saveState() {
  undoStack.push(canvas.toDataURL());
  if (undoStack.length > 50) undoStack.shift();
}

document.getElementById('tool').onchange = e => tool = e.target.value;
document.getElementById('color').onchange = e => color = e.target.value;
document.getElementById('size').onchange = e => size = e.target.value;
document.getElementById('opacity').onchange = e => opacity = e.target.value;

canvas.addEventListener('mousedown', e => {
  drawing = true;
  startX = e.offsetX;
  startY = e.offsetY;
  saveState();
});

canvas.addEventListener('mouseup', () => drawing = false);

canvas.addEventListener('mousemove', e => {
  if (!drawing) return;

  ctx.strokeStyle = color;
  ctx.lineWidth = size;
  ctx.globalAlpha = opacity;
  ctx.lineCap = 'round';

  let x = e.offsetX;
  let y = e.offsetY;

  if (tool === 'brush') {
    ctx.beginPath();
    ctx.moveTo(startX, startY);
    ctx.lineTo(x, y);
    ctx.stroke();
  }

  if (tool === 'eraser') {
    ctx.clearRect(x - size, y - size, size * 2, size * 2);
  }

  if (tool === 'spray') {
    for (let i = 0; i < 20; i++) {
      const offsetX = (Math.random() - 0.5) * size * 2;
      const offsetY = (Math.random() - 0.5) * size * 2;
      ctx.fillStyle = color;
      ctx.fillRect(x + offsetX, y + offsetY, 1, 1);
    }
  }

  if (tool === 'marker') {
    ctx.globalAlpha = 0.2;
    ctx.lineWidth = size * 2;
    ctx.beginPath();
    ctx.moveTo(startX, startY);
    ctx.lineTo(x, y);
    ctx.stroke();
  }

  startX = x;
  startY = y;
});

// UNDO / REDO
undoBtn.onclick = () => {
  if (undoStack.length > 0) {
    redoStack.push(canvas.toDataURL());
    const data = undoStack.pop();
    let img = new Image();
    img.src = data;
    img.onload = () => ctx.drawImage(img, 0, 0);
  }
};

redoBtn.onclick = () => {
  if (redoStack.length > 0) {
    undoStack.push(canvas.toDataURL());
    const data = redoStack.pop();
    let img = new Image();
    img.src = data;
    img.onload = () => ctx.drawImage(img, 0, 0);
  }
};

// Salvar PNG
saveBtn.onclick = () => {
  const link = document.createElement('a');
  link.download = 'desenho.png';
  link.href = canvas.toDataURL();
  link.click();
};

// Importar imagem
importImgBtn.onclick = () => {
  let input = document.createElement('input');
  input.type = 'file';
  input.accept = 'image/*';
  input.onchange = () => {
    let file = input.files[0];
    let img = new Image();
    img.src = URL.createObjectURL(file);
    img.onload = () => ctx.drawImage(img, 0, 0);
  };
  input.click();
};
</script>
</body>
</html>
